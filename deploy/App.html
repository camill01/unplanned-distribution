<!DOCTYPE html>
<html>
<head>
    <title>unplanned-distribution</title>

    <script type="text/javascript" src="/apps/2.1/sdk.js"></script>

    <script type="text/javascript">
        Rally.onReady(function () {
                Ext.define("CustomApp",{extend:"Rally.app.TimeboxScopedApp",scopeType:"release",launch:function(){this.fetchIterations(this.getContext().getTimeboxScope())},onTimeboxScopeChange:function(newTimeboxScope){this.callParent(arguments),this.fetchIterations(newTimeboxScope)},fetchIterations:function(timeboxScope){this._myMask=new Ext.LoadMask(Ext.getBody(),{msg:"Calculating...Please wait."}),this._myMask.show(),this.filters=[];var startDate=timeboxScope.record.raw.ReleaseStartDate,endDate=timeboxScope.record.raw.ReleaseDate,startDateFilter=Ext.create("Rally.data.wsapi.Filter",{property:"StartDate",operator:">=",value:startDate}),endDateFilter=Ext.create("Rally.data.wsapi.Filter",{property:"StartDate",operator:"<",value:endDate});this.filters.push(startDateFilter),this.filters.push(endDateFilter),console.log(""+this.filters);var dataScope=this.getContext().getDataContext(),store=Ext.create("Rally.data.wsapi.Store",{model:"Iteration",fetch:["ObjectID","Name","StartDate","EndDate","PlanEstimate"],context:dataScope,pageSize:this.pagesize,limit:this.pagesize,sorters:[{property:"StartDate",direction:"ASC"}]},this);this.iterations=[],store.addFilter(this.filters,!1),store.loadPage(this.iterationPageCounter,{scope:this,callback:function(records,operation){operation.wasSuccessful()?(console.log("records",records.length,records),records.length>0?(_.each(records,function(record){this.iterations.push(record.get("Name"))},this),console.log(this.iterations)):0===records.length&&0===this.iterations.length?(console.log("no records!"),this.showNoDataBox()):console.log("fetch artifacts!")):console.log("oh,noes!")}})}});

            Rally.launchApp('CustomApp', {
                name:"unplanned-distribution",
	            parentRepos:""
            });

        });
    </script>


    <style type="text/css">
        
    </style>
</head>
<body>
</body>
</html>
